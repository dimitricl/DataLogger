<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sch√©ma de Connexions - DataLogger</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/svg.js/2.7.1/svg.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #2196F3;
            padding-bottom: 10px;
        }
        h2 {
            color: #555;
            margin-top: 30px;
        }
        .schema-container {
            display: flex;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        svg {
            border: 1px solid #ddd;
            background: white;
            border-radius: 4px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #2196F3;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .warning {
            background-color: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
        .info {
            background-color: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä Sch√©ma de Connexions - Module DataLogger</h1>
        <p><strong>Projet :</strong> Barri√®re de Parking - Gestion des logs</p>
        <p><strong>Version :</strong> 0.2 | <strong>Date :</strong> D√©cembre 2024</p>

        <h2>1Ô∏è‚É£ Vue d'ensemble du syst√®me</h2>
        <div class="schema-container">
            <svg width="500" height="400" id="overview"></svg>
        </div>

        <h2>2Ô∏è‚É£ Connexions d√©taill√©es Arduino ‚Üî SD Shield</h2>
        <table>
            <thead>
                <tr>
                    <th>Broche Arduino</th>
                    <th>Broche SD Shield</th>
                    <th>Signal SPI</th>
                    <th>Fonction</th>
                    <th>Type</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>5V</strong></td>
                    <td>VCC</td>
                    <td>Alimentation</td>
                    <td>Tension positive 5V</td>
                    <td>‚ö° Puissance</td>
                </tr>
                <tr>
                    <td><strong>GND</strong></td>
                    <td>GND</td>
                    <td>Masse</td>
                    <td>R√©f√©rence commune (0V)</td>
                    <td>‚ö° Puissance</td>
                </tr>
                <tr>
                    <td><strong>Pin 5</strong></td>
                    <td>CS</td>
                    <td>Chip Select</td>
                    <td>S√©lectionne le p√©riph√©rique SD</td>
                    <td>üîß Donn√©es</td>
                </tr>
                <tr>
                    <td><strong>Pin 11</strong></td>
                    <td>MOSI</td>
                    <td>Master Out Slave In</td>
                    <td>Donn√©es Arduino ‚Üí SD</td>
                    <td>üîß Donn√©es</td>
                </tr>
                <tr>
                    <td><strong>Pin 12</strong></td>
                    <td>MISO</td>
                    <td>Master In Slave Out</td>
                    <td>Donn√©es SD ‚Üí Arduino</td>
                    <td>üîß Donn√©es</td>
                </tr>
                <tr>
                    <td><strong>Pin 13</strong></td>
                    <td>SCK</td>
                    <td>Serial Clock</td>
                    <td>Horloge SPI (d√©bit de donn√©es)</td>
                    <td>üîß Donn√©es</td>
                </tr>
            </tbody>
        </table>

        <h2>3Ô∏è‚É£ Connexions des capteurs</h2>
        <table>
            <thead>
                <tr>
                    <th>Broche Arduino</th>
                    <th>Capteur</th>
                    <th>Type</th>
                    <th>Plage</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>A0</strong></td>
                    <td>Capteur position</td>
                    <td>Analogique</td>
                    <td>0 - 1023</td>
                    <td>D√©tecte la position de la barri√®re (lev√©e/baiss√©e)</td>
                </tr>
                <tr>
                    <td><strong>A1</strong></td>
                    <td>Capteur temp√©rature</td>
                    <td>Analogique</td>
                    <td>0 - 1023</td>
                    <td>Surveillance thermique du syst√®me</td>
                </tr>
                <tr>
                    <td><strong>GND</strong></td>
                    <td>Masse capteurs</td>
                    <td>-</td>
                    <td>-</td>
                    <td>R√©f√©rence commune pour tous les capteurs</td>
                </tr>
            </tbody>
        </table>

        <div class="info">
            <strong>‚ÑπÔ∏è Info SPI (Serial Peripheral Interface)</strong><br>
            Le protocole SPI utilise 4 signaux principaux pour communiquer :
            <ul>
                <li><strong>CS</strong> : S√©lectionne le composant √† utiliser</li>
                <li><strong>MOSI</strong> : Ma√Ætre (Arduino) envoie au slave (SD)</li>
                <li><strong>MISO</strong> : Slave (SD) r√©pond au ma√Ætre (Arduino)</li>
                <li><strong>SCK</strong> : Horloge synchronisant les transferts</li>
            </ul>
        </div>

        <h2>4Ô∏è‚É£ Sch√©ma d'alimentation</h2>
        <div class="schema-container">
            <svg width="500" height="300" id="power"></svg>
        </div>

        <h2>5Ô∏è‚É£ Sch√©ma de c√¢blage d√©taill√©</h2>
        <div class="schema-container">
            <svg width="600" height="500" id="detailed"></svg>
        </div>

        <div class="warning">
            <strong>‚ö†Ô∏è Pr√©cautions importantes</strong>
            <ul>
                <li>V√©rifiez que les branchements sont corrects <strong>avant</strong> d'alimenter</li>
                <li>Utilisez une tension stable de 5V pour la SD (risque de corruption)</li>
                <li>Tous les GND doivent √™tre connect√©s ensemble</li>
                <li>La carte SD doit √™tre <strong>format√©e en FAT32</strong></li>
                <li>D√©connectez l'Arduino avant de brancher/d√©brancher la SD</li>
                <li>Les broche 11, 12, 13 sont d√©di√©es au SPI (ne pas modifier)</li>
            </ul>
        </div>

        <h2>6Ô∏è‚É£ Proc√©dure de montage</h2>
        <ol>
            <li><strong>Arr√™tez</strong> l'Arduino (d√©branchez le c√¢ble USB)</li>
            <li><strong>Pr√©parez</strong> la breadboard et les c√¢bles</li>
            <li><strong>Connectez</strong> le SD Shield sur la breadboard</li>
            <li><strong>Reliez</strong> Arduino ‚Üí SD Shield (5V, GND, Pin 5, 11, 12, 13)</li>
            <li><strong>Branchez</strong> les capteurs analogiques (A0, A1)</li>
            <li><strong>Ins√©rez</strong> la carte SD (format√©e FAT32) dans le shield</li>
            <li><strong>Reconnectez</strong> l'Arduino en USB</li>
            <li><strong>T√©l√©versez</strong> le code (demo.ino)</li>
            <li><strong>V√©rifiez</strong> les messages dans le Serial Monitor (115200 bauds)</li>
        </ol>

        <div class="info">
            <strong>‚úÖ V√©rifications √† faire</strong>
            <ul>
                <li>Serial Monitor affiche "OK ‚úÖ" pour l'initialisation SD</li>
                <li>Les logs sont cr√©√©s et visibles sur la carte SD</li>
                <li>Les valeurs de capteurs varient dans une plage raisonnable</li>
                <li>Pas de message d'erreur apr√®s 1 minute de fonctionnement</li>
            </ul>
        </div>
    </div>

    <script>
        // Sch√©ma 1: Vue d'ensemble
        function drawOverview() {
            var svg = SVG('overview');
            
            // Bo√Ætes principales
            svg.rect(100, 60).attr({x: 20, y: 20, fill: '#e3f2fd', stroke: '#2196F3', 'stroke-width': 2});
            svg.text('ARDUINO').move(40, 40).attr({'font-weight': 'bold', 'font-size': '14px'});
            
            svg.rect(100, 60).attr({x: 180, y: 20, fill: '#fff3cd', stroke: '#ffc107', 'stroke-width': 2});
            svg.text('SD Shield').move(200, 40).attr({'font-weight': 'bold', 'font-size': '14px'});
            
            svg.rect(100, 60).attr({x: 350, y: 20, fill: '#f0f4c3', stroke: '#8bc34a', 'stroke-width': 2});
            svg.text('Carte SD').move(370, 40).attr({'font-weight': 'bold', 'font-size': '14px'});
            
            // Fl√®ches
            svg.line(120, 50).to(180, 50).stroke({width: 2, color: '#2196F3'});
            svg.line(280, 50).to(350, 50).stroke({width: 2, color: '#2196F3'});
            
            // Capteurs
            svg.rect(80, 50).attr({x: 45, y: 140, fill: '#e8f5e9', stroke: '#4caf50', 'stroke-width': 2});
            svg.text('Capteur A0').move(50, 157).attr({'font-size': '12px'});
            
            svg.rect(80, 50).attr({x: 195, y: 140, fill: '#e8f5e9', stroke: '#4caf50', 'stroke-width': 2});
            svg.text('Capteur A1').move(200, 157).attr({'font-size': '12px'});
            
            // Connexions
            svg.line(85, 140).to(85, 80).stroke({width: 1, color: '#666', dasharray: '5'});
            svg.line(235, 140).to(235, 80).stroke({width: 1, color: '#666', dasharray: '5'});
            
            // Textes
            svg.text('SPI').move(220, 100).attr({'font-size': '12px', 'fill': '#666'});
            svg.text('I/O').move(90, 110).attr({'font-size': '10px', 'fill': '#666'});
        }

        // Sch√©ma 2: Alimentation
        function drawPower() {
            var svg = SVG('power');
            
            // Source
            svg.text('USB 5V').move(30, 20).attr({'font-weight': 'bold'});
            svg.circle(30).center(150, 40);
            svg.text('+').center(150, 40).attr({'fill': 'white', 'font-weight': 'bold', 'font-size': '20px'});
            
            // Distribution
            svg.line(150, 70).to(150, 100).stroke({width: 2, color: '#d32f2f'});
            
            // Rails
            svg.line(50, 120).to(400, 120).stroke({width: 3, color: '#d32f2f'});
            svg.line(50, 160).to(400, 160).stroke({width: 3, color: '#000'});
            
            svg.text('+5V').move(10, 110).attr({'fill': '#d32f2f', 'font-weight': 'bold'});
            svg.text('GND').move(10, 150).attr({'fill': '#000', 'font-weight': 'bold'});
            
            // Composants
            [80, 150, 220, 290, 360].forEach(function(x, i) {
                svg.rect(40, 30).attr({x: x-20, y: 115, fill: '#f5f5f5', stroke: '#999'});
                var labels = ['Arduino', 'SD Shield', 'Cap. A0', 'Cap. A1', 'LED'];
                svg.text(labels[i]).move(x-30, 120).attr({'font-size': '11px'});
            });
        }

        // Sch√©ma 3: C√¢blage d√©taill√©
        function drawDetailed() {
            var svg = SVG('detailed');
            
            // Arduino
            svg.rect(100, 200).attr({x: 30, y: 80, fill: '#bbdefb', stroke: '#1976d2', 'stroke-width': 2});
            svg.text('Arduino').move(50, 170).attr({'font-weight': 'bold'});
            
            // Broches
            var pins = ['5V', 'GND', 'Pin5', 'Pin11', 'Pin12', 'Pin13', 'A0', 'A1'];
            pins.forEach(function(pin, i) {
                var y = 100 + i*20;
                svg.text(pin).move(40, y).attr({'font-size': '11px'});
                svg.circle(4).center(130, y+6).attr({fill: '#1976d2'});
            });
            
            // SD Shield
            svg.rect(100, 200).attr({x: 380, y: 80, fill: '#fff9c4', stroke: '#f57f17', 'stroke-width': 2});
            svg.text('SD Shield').move(395, 170).attr({'font-weight': 'bold'});
            
            var sdPins = ['VCC', 'GND', 'CS', 'MOSI', 'MISO', 'SCK'];
            sdPins.forEach(function(pin, i) {
                if (i < 6) {
                    var y = 100 + i*20;
                    svg.text(pin).move(385, y).attr({'font-size': '11px'});
                    svg.circle(4).center(380, y+6).attr({fill: '#f57f17'});
                }
            });
            
            // Connexions
            var connections = [
                {from: [130, 100], to: [380, 100], label: '5V'},
                {from: [130, 120], to: [380, 120], label: 'GND'},
                {from: [130, 140], to: [380, 160], label: 'CS'},
                {from: [130, 160], to: [380, 180], label: 'MOSI'},
                {from: [130, 180], to: [380, 200], label: 'MISO'},
                {from: [130, 200], to: [380, 220], label: 'SCK'},
            ];
            
            connections.forEach(function(c) {
                svg.line(c.from[0], c.from[1]).to(c.to[0], c.to[1])
                    .stroke({width: 2, color: '#2196f3'});
                var mx = (c.from[0] + c.to[0]) / 2;
                var my = (c.from[1] + c.to[1]) / 2;
                svg.text(c.label).move(mx-10, my-10).attr({'font-size': '9px', 'fill': '#2196f3'});
            });
        }

        // G√©n√©rer les sch√©mas
        drawOverview();
        drawPower();
        drawDetailed();
    </script>
</body>
</html>
